import{u as v,a as _,p as w,r as S,d as V,A as P,k as d,c as m,b as u,f,l as C,h as I,o as y}from"./index-D6IdYIOx.js";import{u as g}from"./useMutation-BFuSot1U.js";import{u as Q}from"./useReturnVisits-BBX5RBm0.js";function R(){const a=v();return g({mutationFn:async t=>{const s=t.map(e=>_("people",e));return(await Promise.allSettled(s)).filter(e=>e.status==="fulfilled").map(e=>e.value)},onSuccess:()=>{a.invalidateQueries({queryKey:w.all()})}})}function k(){const a=v();return g({mutationFn:async t=>{const s=t.map(e=>_("returnVisits",e));return(await Promise.allSettled(s)).filter(e=>e.status==="fulfilled").map(e=>e.value)},onSuccess:()=>{a.invalidateQueries({queryKey:S.all()})}})}const q={class:"max-w-prose mx-auto py-2 px-3"},E={class:"flex gap-3 justify-center"},N=["href","download"],j={key:0,class:"bg-lemon-600 rounded px-2 py-1 text-lemon-50 cursor-pointer",for:"fileInput"},L=V({__name:"AppConfig",setup(a){const t=P(),s=Q(),n=I(),e=R(),l=k(),x=d(()=>{if(t.isLoading.value||s.isLoading.value)return;const r={people:t.data.value??[],returnVisits:s.data.value??[]},i=new Blob([JSON.stringify(r)],{type:"application/json"});return URL.createObjectURL(i)}),b=d(()=>new Date().toISOString()+".return-visits");async function h(r){if(!confirm(`¿Segura que deseas importar estos datos?
Esto sobreescribirá los datos actuales.`))return;const o=r.target.files;if(!(o!=null&&o[0])){alert("Error en importación de datos");return}try{const c=o[0],p=JSON.parse(await c.text());await e.mutateAsync(p.people),await l.mutateAsync(p.returnVisits),n.back()}catch{alert("Error en la importación")}}return(r,i)=>(y(),m("main",q,[u("div",E,[u("a",{href:x.value,download:b.value,class:"bg-asparagus-600 rounded px-2 py-1 text-asparagus-50"}," Exportar datos ",8,N),u("input",{id:"fileInput",class:"hidden",onChange:h,type:"file",accept:".return-visits,application/json"},null,32),!f(l).isPending.value&&!f(e).isPending.value?(y(),m("label",j," Importar datos ")):C("",!0)])]))}});export{L as default};
